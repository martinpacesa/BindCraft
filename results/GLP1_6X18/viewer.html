<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>GLP-1 Designs - Visualiseur</title>
    <script src="https://3Dmol.csb.pitt.edu/build/3Dmol-min.js"></script>
    <style>
        * {margin:0;padding:0;box-sizing:border-box;}
        body {font-family:Arial,sans-serif;background:#667eea;padding:20px;}
        .container {max-width:1200px;margin:auto;background:white;border-radius:8px;box-shadow:0 0 40px rgba(0,0,0,0.3);}
        .header {background:linear-gradient(135deg,#667eea,#764ba2);color:white;padding:20px;text-align:center;}
        .header h1 {margin:0;font-size:2em;}
        .content {display:grid;grid-template-columns:1fr 300px;gap:0;}
        #viewer {width:100%;height:600px;background:#f5f5f5;}
        .sidebar {padding:20px;border-left:1px solid #ddd;}
        .designs {margin:20px 0;}
        .design-btn {display:block;width:100%;padding:12px;margin:5px 0;background:#667eea;color:white;border:none;border-radius:4px;cursor:pointer;font-weight:bold;}
        .design-btn:hover {background:#764ba2;}
        .design-btn.active {background:#764ba2;border:2px solid white;}
        .metrics {background:#f5f5f5;padding:15px;border-radius:4px;margin:15px 0;}
        .metric {margin:8px 0;}
        .metric-label {font-size:0.8em;color:#666;font-weight:bold;text-transform:uppercase;}
        .metric-value {font-size:1.4em;color:#667eea;font-weight:bold;}
        .controls {margin:15px 0;}
        select,button {width:100%;padding:8px;margin:5px 0;border:1px solid #ddd;border-radius:4px;cursor:pointer;}
        button {background:white;color:#667eea;border:2px solid #667eea;font-weight:bold;}
        button:hover {background:#f5f5ff;}
        .list {max-height:300px;overflow-y:auto;font-size:0.85em;}
        .file-link {display:block;padding:5px;margin:3px 0;background:#f9f9f9;border-radius:3px;text-decoration:none;color:#333;border-left:3px solid #667eea;}
        .file-link:hover {background:#e9e9f9;}
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ§¬ GLP-1 Peptide Designs (10 structures)</h1>
            <p>SÃ©lectionne un design pour le visualiser</p>
        </div>
        <div class="content">
            <div id="viewer"></div>
            <div class="sidebar">
                <h3>Designs disponibles:</h3>
                <div class="designs" id="designs"></div>
                
                <div class="metrics" id="metrics" style="display:none;">
                    <div class="metric">
                        <div class="metric-label">pLDDT</div>
                        <div class="metric-value" id="plddt">-</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">PAE</div>
                        <div class="metric-value" id="pae">-</div>
                    </div>
                    <div class="metric">
                        <div class="metric-label">Longueur</div>
                        <div class="metric-value" id="length">-</div>
                    </div>
                </div>
                
                <div class="controls">
                    <label>Style:</label>
                    <select onchange="changeStyle(this.value)">
                        <option value="cartoon">Cartoon</option>
                        <option value="stick">Stick</option>
                        <option value="sphere">Sphere</option>
                    </select>
                    <button onclick="spin()">ğŸ”„ Rotation</button>
                    <button onclick="reset()">â†» Reset</button>
                </div>
                
                <h3 style="margin-top:20px;">ğŸ“‚ Fichiers:</h3>
                <div class="list">
                    <a href="structures/GLP1_design_001.pdb" class="file-link" download>ğŸ“„ Design 001.pdb</a>
                    <a href="structures/GLP1_design_002.pdb" class="file-link" download>ğŸ“„ Design 002.pdb</a>
                    <a href="structures/GLP1_design_003.pdb" class="file-link" download>ğŸ“„ Design 003.pdb</a>
                    <a href="structures/GLP1_design_004.pdb" class="file-link" download>ğŸ“„ Design 004.pdb</a>
                    <a href="structures/GLP1_design_005.pdb" class="file-link" download>ğŸ“„ Design 005.pdb</a>
                    <a href="structures/GLP1_design_006.pdb" class="file-link" download>ğŸ“„ Design 006.pdb â­</a>
                    <a href="structures/GLP1_design_007.pdb" class="file-link" download>ğŸ“„ Design 007.pdb</a>
                    <a href="structures/GLP1_design_008.pdb" class="file-link" download>ğŸ“„ Design 008.pdb</a>
                    <a href="structures/GLP1_design_009.pdb" class="file-link" download>ğŸ“„ Design 009.pdb</a>
                    <a href="structures/GLP1_design_010.pdb" class="file-link" download>ğŸ“„ Design 010.pdb</a>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        let viewer = null;
        let currentDesign = null;
        
        const designs = [
            {id:1,plddt:0.828,pae:13.28,length:30,seq:"RPFTGGSVVHTLFVEGTDDVWGKTTVGCEE"},
            {id:2,plddt:0.89,pae:14.92,length:30,seq:"RVQEMVRPYFKSHDSIGLMQDGFSVLTMSR"},
            {id:3,plddt:0.795,pae:8.26,length:40,seq:"EAGLTASSTFNLWTEAFFTVTTTLVEEQPLMTGMSEGGDE"},
            {id:4,plddt:0.809,pae:5.37,length:30,seq:"QGAKAFSTQLSVDTFIEAPLEATGFLALAR"},
            {id:5,plddt:0.911,pae:7.71,length:40,seq:"TTWGTLVEMASFVFFQFQSFLTSAEVTGTRESFAPYKSGD"},
            {id:6,plddt:0.925,pae:5.49,length:40,seq:"RFMIESTTAETGDGSEDGMQWQTSHAAYNEAKTTTKTGLE",top:true},
            {id:7,plddt:0.811,pae:8.33,length:40,seq:"KLLAGYCYFASEAPFIGGHLHSGNSSFRRTCFVFEWTTGG"},
            {id:8,plddt:0.89,pae:13.86,length:40,seq:"NHENAEQTSWRLYLKYGAIGEFCFPQAPSTAVQVLFGAVT"},
            {id:9,plddt:0.793,pae:8.85,length:40,seq:"ETEREAEVFVLHGGAGNDFTFQAVTGSVVFPVEAVEPVFE"},
            {id:10,plddt:0.763,pae:5.39,length:30,seq:"KFVEVSLVLTTAEGLLVWSKIHTVTSLRYE"}
        ];
        
        function init() {
            let config = {backgroundColor:'white'};
            viewer = $3Dmol.createViewer(document.getElementById("viewer"), config);
            
            // CrÃ©er les boutons
            const container = document.getElementById("designs");
            designs.forEach(d => {
                const btn = document.createElement("button");
                btn.className = "design-btn";
                btn.textContent = `Design ${d.id.toString().padStart(2,'0')} (pLDDT: ${d.plddt.toFixed(3)})${d.top?' â­':''}`;
                btn.onclick = () => loadDesign(d);
                if(d.id === 6) btn.classList.add("active");
                container.appendChild(btn);
            });
            
            loadDesign(designs[5]); // Charger Design 6 par dÃ©faut
        }
        
        function loadDesign(design) {
            currentDesign = design;
            
            // Mettre Ã  jour boutons
            document.querySelectorAll(".design-btn").forEach(btn => btn.classList.remove("active"));
            event.target.classList.add("active");
            
            // Mettre Ã  jour mÃ©triques
            document.getElementById("plddt").textContent = design.plddt.toFixed(3);
            document.getElementById("pae").textContent = design.pae.toFixed(2) + " Ã…";
            document.getElementById("length").textContent = design.length + " AA";
            document.getElementById("metrics").style.display = "block";
            
            // Charger le fichier PDB
            const url = `structures/GLP1_design_${design.id.toString().padStart(3,'0')}.pdb`;
            fetch(url)
                .then(r => r.text())
                .then(pdb => {
                    viewer.clear();
                    viewer.addModel(pdb, "pdb");
                    viewer.setStyle({}, {cartoon:{color:'spectrum'}});
                    viewer.zoomTo();
                    viewer.render();
                })
                .catch(e => alert("Erreur: " + e.message + "\nFichier: " + url));
        }
        
        function changeStyle(style) {
            viewer.setStyle({}, {});
            const config = {};
            config[style] = {color:'spectrum'};
            viewer.setStyle({}, config);
            viewer.render();
        }
        
        function spin() { viewer.spin(true); }
        function reset() { viewer.zoomTo(); viewer.render(); }
        
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
